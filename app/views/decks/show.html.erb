<div class="section row">
  <div class="col s12">
    <div class="card">
      <div class="card-content blue-grey lighten-5">
        <span class="card-title black-text"><%= @deck.name %></span>
        <p><%= @deck.description %></p>
      </div>
      <div class="card-action">
        main: <%= @deck.percent_owned(current_user, :main) %>%
        sideboard: <%= @deck.percent_owned(current_user, :sideboard) %>%
      </div>
      <div class="card-action">
        pre√ßo: <%= number_to_currency @deck.total_price %>
      </div>
    </div>
  </div>
</div>

<div class="section row">
  <div class="col s12">
    <h5>Stats</h5>
    <ul class="collapsible" data-collapsible="accordion">
      <li>
        <div class="collapsible-header">Manacost</div>
        <div class="collapsible-body">
          <canvas id="manacost_chart"></canvas>
        </div>
      </li>
      <li>
        <div class="collapsible-header">Types</div>
        <div class="collapsible-body">
          <canvas id="type_chart"></canvas>
        </div>
      </li>
      <li>
        <div class="collapsible-header">Color</div>
        <div class="collapsible-body">
          <canvas id="color_chart"></canvas>
        </div>
      </li>
    </ul>
  </div>
</div>

<div class="row">
  <div class="col s12">
    <%= render 'deck_box', deck: @deck %>
  </div>
</div>

<%= link_to 'Back', decks_path %>

<script>
var data = {
labels: <%= @deck.by_manacost.keys.sort %>,  
        datasets: [
        { data: <%= @deck.total_by_manacost.values %> }
        ]
};
var ctx = document.getElementById("manacost_chart").getContext("2d");
var myNewChart = new Chart(ctx).Bar(data);

var data2 = {
labels: <%= raw @deck.total_by_type.keys.map {|i| i[0]} %>,  
        datasets: [
        { data: <%= @deck.total_by_type.values %> }
        ]
};
var ctx2 = document.getElementById("type_chart").getContext("2d");
var myNewChart2 = new Chart(ctx2).Bar(data2);


var data3 = {
labels: <%= raw @deck.total_by_color.keys.map {|i| i[0]}.map(&:capitalize) %>,  
        datasets: [
        { data: <%= @deck.total_by_color.values %> }
        ]
};
var ctx3 = document.getElementById("color_chart").getContext("2d");
var myNewChart3 = new Chart(ctx3).Bar(data3);
</script>
